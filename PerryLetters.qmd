---
title: "PerryLetters"
---

Textual Analysis
Corpi: Benjamin F. Perry Letters and Elizabeth Frances McCall Perry Letters
Collections located at the South Caroliniana Archive
Transcribed by Allen Stokes (retired director of South Caroliniana)

Load Text Anaylsis/Tidy Data libraries
```{r}
#install.packages("tidytext")
#install.packages("readtext")
#install.packages("widyr")
#install.packages("SnowballC")
```

Seems to work better if you install the packages one at a time, rather than how I coded it above. Maybe should just run install.packages() directly on the command line?

```{r}
library("tidyverse")
library("tidytext") 
library("readtext")
library("widyr")
library("SnowballC")
```

Load BFPerryTranscribedLetters txt document and use readtext to :

```{r}
BFPLetters_file_path <- "/Users/crboatwright/PerryLetters/BFPerryTranscribedLetters.txt"
BFPLetters_text_data <- readtext(BFPLetters_file_path)
head(BFPLetters_text_data)
```

Tokenize the text by word:
- This also makes the text lowercase and removed punctuation

```{r}
tidy_BFPLetters <- BFPLetters_text_data %>%
    unnest_tokens(word, text)

tidy_BFPLetters
```

Tokenize by sentence:

```{r}
tidy_BFPLetters_sentences <- BFPLetters_text_data %>%
    unnest_tokens(sentence, text, token = "sentences")

tidy_BFPLetters_sentences
```

Error above. Probably because dataframe isn't property formatted.

```{r}
install.packages("tm")
```

```{r}
tidy_BFPLetters_stopwords <- tidy_BFPLetters %>%
    anti_join(stop_words)
```

```{r}
# Add a filename column to tidy_BFPLetters
tidy_BFPLetters <- tidy_BFPLetters %>%
    mutate(filename = "BFPerryTranscribedLetters.txt")

# Now create the Document Term Matrix (DTM)
tidy_BFPLetters_words <- tidy_BFPLetters %>%
    count(filename, word)

head(tidy_BFPLetters_words)

BFPLetters_dtm <- tidy_BFPLetters_words %>%
    cast_dtm(filename, word, n)
```

Format text for Document Term Matrix (DTM):
- Actually done above, this created a column filename and then created the DTM. Two chuncks below produced errors.

```{r}
tidy_BFPLetters_words <- tidy_BFPLetters %>% count(filename, word)

head(tidy_BFPLetters_words)
```

```{r}
BFPLetters_dtm <- tidy_BFPLetters_words %>%
    count(filename, word) %>%
    cast_dtm(filename, word, n)
```

Train model: 
- Uses LDA

Load topicmodels package:

```{r}
install.packages("topicmodels")
```
```{r}
BFP.lda <- LDA(BFPLetters_dtm, k = 5, control = list(seed = 12345))
BFP.lda
```